================================================================================
PROMPT DE ALINHAMENTO ‚Äî FRONTEND
M√ìDULO / P√ÅGINA DE PEDIDOS (VIS√ÉO BALC√ÉO / GERENTE)
================================================================================

Data: 21 de Fevereiro de 2026
Vers√£o: 2.0 - Alinhado com Backend Real


CONTEXTO GERAL
================================================================================

Estamos a construir uma PLATAFORMA OPERACIONAL DE CONSUMO,
n√£o um simples sistema de pedidos.

O frontend deve refletir fielmente o MODELO DE DOM√çNIO j√° implementado no backend,
onde:
- Estado √© consequ√™ncia de regras (StatusPedido √© DERIVADO dos SubPedidos)
- Pedido √© um agregado (cont√©m SubPedidos e ItemPedidos)
- SubPedidos representam unidades reais de produ√ß√£o (uma por Cozinha)
- Pagamento √© um eixo separado do fluxo operacional (StatusFinanceiroPedido)

A UI N√ÉO define regras de neg√≥cio.
A UI apenas PROJETA o estado do dom√≠nio.


================================================================================
1. CONCEITO CENTRAL DA P√ÅGINA DE PEDIDOS
================================================================================

A p√°gina de pedidos representa:
‚Üí UMA UNIDADE DE CONSUMO ATIVA (mesa, balc√£o, QR, delivery futuro)

Ela deve permitir:
- Visualizar o estado atual do consumo
- Criar pedidos
- Acompanhar SubPedidos por Cozinha
- Entender claramente o estado operacional e financeiro

N√ÉO √© uma tela de "checkout".
√â um PAINEL OPERACIONAL DE CONSUMO.


================================================================================
2. ENTIDADES DO DOM√çNIO QUE O FRONTEND PRECISA RESPEITAR
================================================================================

O frontend deve trabalhar com as seguintes entidades EXATAMENTE como est√£o no backend:

‚úÖ UnidadeDeConsumo
   - Mesa, balc√£o, quarto, √°rea de evento
   - Tem status: DISPONIVEL, OCUPADA, AGUARDANDO_PAGAMENTO, FINALIZADA

‚úÖ Pedido
   - Agregado principal
   - Cont√©m m√∫ltiplos SubPedidos
   - Tem StatusPedido: CRIADO, EM_ANDAMENTO, FINALIZADO, CANCELADO
   - Tem StatusFinanceiroPedido: NAO_PAGO, PAGO, ESTORNADO

‚úÖ SubPedido
   - Unidade operacional real
   - SEMPRE associado a UMA Cozinha
   - Tem StatusSubPedido: CRIADO, PENDENTE, EM_PREPARACAO, PRONTO, ENTREGUE, CANCELADO
   - Estados independentes (permite trabalho paralelo)

‚úÖ ItemPedido
   - Produto espec√≠fico dentro de um SubPedido
   - Quantidade, pre√ßo unit√°rio, subtotal
   - Relacionado ao Produto

‚úÖ Cozinha
   - Unidade de produ√ß√£o (n√£o usar "UnidadeDeProducao")
   - Tem TipoCozinha: PRINCIPAL, GRILL, SUSHI, BAR, CONFEITARIA, etc
   - Recebe SubPedidos para prepara√ß√£o

‚úÖ Cliente
   - Associado √† UnidadeDeConsumo quando ocupada
   - Tem FundoConsumo (pr√©-pago) opcional


IMPORTANTE:
O frontend N√ÉO cria SubPedido diretamente.
Ele cria um Pedido, e o backend deriva os SubPedidos automaticamente baseado 
no TipoPreparo dos produtos (QUENTE ‚Üí Cozinha, BAR ‚Üí Bar, etc).


================================================================================
3. FLUXO MENTAL CORRETO PARA O FRONTEND
================================================================================

O frontend deve pensar assim:

1. Existe uma UnidadeDeConsumo ativa (status = OCUPADA)

2. Essa unidade pode ter:
   - 0 ou N Pedidos no hist√≥rico
   - 0 ou 1 Pedido ATIVO (status != FINALIZADO && status != CANCELADO)

3. Um Pedido ATIVO:
   - Tem StatusPedido (operacional): CRIADO | EM_ANDAMENTO | FINALIZADO
   - Tem StatusFinanceiroPedido (financeiro): NAO_PAGO | PAGO | ESTORNADO
   - √â composto por 1 ou mais SubPedidos

4. Cada SubPedido:
   - Pertence a UMA Cozinha espec√≠fica
   - Tem status INDEPENDENTE dos outros SubPedidos
   - Cont√©m 1 ou mais ItemPedidos

5. StatusPedido √© CALCULADO pelo backend:
   - Todos SubPedidos CRIADO/PENDENTE ‚Üí CRIADO
   - Qualquer SubPedido EM_PREPARACAO/PRONTO ‚Üí EM_ANDAMENTO
   - Todos SubPedidos ENTREGUE ‚Üí FINALIZADO
   - Todos SubPedidos CANCELADO ‚Üí CANCELADO

A UI deve SEMPRE refletir essa hierarquia.


================================================================================
4. ORGANIZA√á√ÉO VISUAL DA P√ÅGINA DE PEDIDOS
================================================================================

A p√°gina deve ser organizada em BLOCOS CONCEITUAIS:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A) CONTEXTO DO CONSUMO                                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ ü™ë Mesa 15 (Sal√£o Principal)                    Status: OCUPADA             ‚îÇ
‚îÇ üë§ Cliente: Jo√£o Pedro Afonso                                               ‚îÇ
‚îÇ üí≥ Tipo: Pr√©-pago com Fundo                                                 ‚îÇ
‚îÇ üí∞ Saldo Dispon√≠vel: 8.500,00 AOA                                           ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ B) PEDIDO ATIVO                                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ üìã Pedido: PED-20260221-001                                                 ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ Status Operacional: üîÑ EM_ANDAMENTO                                         ‚îÇ
‚îÇ Status Financeiro:  üí≥ PAGO (Fundo de Consumo)                              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ Total Pedido: 12.500,00 AOA                                                 ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ C) SUBPEDIDOS AGRUPADOS POR COZINHA                                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ üç≥ COZINHA PRINCIPAL (PED-001-1)                                            ‚îÇ
‚îÇ    Status: EM_PREPARACAO                                                    ‚îÇ
‚îÇ    ‚îú‚îÄ 1x Muamba de Galinha ..................... 8.500,00 AOA              ‚îÇ
‚îÇ    ‚îî‚îÄ 1x Arroz Branco .......................... 1.000,00 AOA              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ üçπ BAR (PED-001-2)                                                          ‚îÇ
‚îÇ    Status: PRONTO                                                           ‚îÇ
‚îÇ    ‚îî‚îÄ 2x Cerveja Cuca .......................... 3.000,00 AOA              ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ D) A√á√ïES PERMITIDAS (baseadas no estado)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                             ‚îÇ
‚îÇ [+ Adicionar Produtos]  [üìä Ver Hist√≥rico]  [‚ùå Cancelar Pedido]            ‚îÇ
‚îÇ                                                                             ‚îÇ
‚îÇ ‚ö†Ô∏è "Finalizar Pedido" desabilitado: SubPedido PED-001-1 ainda EM_PREPARACAO‚îÇ
‚îÇ                                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


AGRUPAMENTO POR COZINHA:
- Use subPedido.cozinha.nome (ex: "Cozinha Principal", "Bar", "Grill")
- Use subPedido.cozinha.tipo (TipoCozinha enum) para √≠cones/cores
- N√£o invente categorias que n√£o existem no backend
- Exemplo de mapeamento de √≠cones:
  ‚Ä¢ PRINCIPAL ‚Üí üç≥
  ‚Ä¢ GRILL ‚Üí üî•
  ‚Ä¢ BAR ‚Üí üçπ
  ‚Ä¢ SUSHI ‚Üí üç£
  ‚Ä¢ CONFEITARIA ‚Üí üç∞


================================================================================
5. REGRAS IMPORTANTES PARA O FRONTEND (N√ÉO NEGOCI√ÅVEIS)
================================================================================

‚úÖ Nunca permitir "Conta sem Pedido"
   ‚Üí UnidadeDeConsumo s√≥ pode ter conta se houver Pedido associado

‚úÖ Nunca permitir pagamento sem Pedido
   ‚Üí Endpoint /api/pagamentos requer pedidoId obrigat√≥rio

‚úÖ Nunca permitir a√ß√µes fora de contexto
   ‚Üí Exemplo: N√£o mostrar "Finalizar Pedido" se StatusPedido != EM_ANDAMENTO

‚úÖ Nunca inferir estado manualmente
   ‚Üí StatusPedido vem do backend (derivado dos SubPedidos)

‚úÖ Nunca "simular" mudan√ßa de status
   ‚Üí Toda mudan√ßa vem do backend via API

‚úÖ Nunca criar SubPedido manualmente
   ‚Üí Backend cria automaticamente ao receber Pedido

‚úÖ Respeitar estados terminais
   ‚Üí FINALIZADO e CANCELADO n√£o permitem mais altera√ß√µes

‚úÖ Validar disponibilidade de produtos
   ‚Üí Usar campo produto.ativo (n√£o existe mais campo disponivel)


================================================================================
6. COMPORTAMENTO REATIVO DA UI
================================================================================

A UI deve ser REATIVA a eventos do backend via WebSocket:

CONEX√ÉO WEBSOCKET:
- Endpoint: ws://localhost:8080/api/ws
- Protocolo: STOMP over WebSocket
- Fallback: SockJS

T√ìPICOS A SUBSCREVER:

1) /topic/pedido/{pedidoId}
   ‚Üí Recebe atualiza√ß√µes do Pedido
   ‚Üí Atualiza StatusPedido, StatusFinanceiroPedido, total

2) /topic/subpedido/{subPedidoId}
   ‚Üí Recebe atualiza√ß√µes de SubPedido espec√≠fico
   ‚Üí Atualiza StatusSubPedido, timestamps

3) /topic/atendente/unidade/{unidadeId}
   ‚Üí Recebe notifica√ß√µes quando SubPedido fica PRONTO
   ‚Üí Alert visual/sonoro para buscar na cozinha

4) /topic/cozinha/{cozinhaId}
   ‚Üí (Opcional) Para tela de cozinha
   ‚Üí Novos SubPedidos chegando

EXEMPLO DE INTEGRA√á√ÉO:
```javascript
stompClient.subscribe('/topic/pedido/123', (message) => {
    const notificacao = JSON.parse(message.body);
    // Atualizar UI:
    // - Status do pedido
    // - Status dos SubPedidos
    // - Total atualizado
    atualizarPedidoNaUI(notificacao);
});

stompClient.subscribe('/topic/atendente/unidade/5', (message) => {
    const notificacao = JSON.parse(message.body);
    if (notificacao.statusSubPedido === 'PRONTO') {
        // Mostrar alerta: "SubPedido PED-001-2 pronto para retirada!"
        mostrarAlertaSubPedidoPronto(notificacao);
    }
});
```

A UI n√£o pergunta "o que fazer".
Ela pergunta "qual √© o estado atual" e reage a mudan√ßas.


================================================================================
7. CHAMADAS API NECESS√ÅRIAS
================================================================================

CRIAR PEDIDO:
POST /api/pedidos
{
  "unidadeConsumoId": 15,
  "tipoPagamento": "FUNDO_CONSUMO",
  "observacoes": "Sem cebola",
  "itens": [
    {
      "produtoId": 1,
      "quantidade": 1,
      "observacoes": "Bem passado"
    },
    {
      "produtoId": 5,
      "quantidade": 2
    }
  ]
}

Backend automaticamente:
- Cria Pedido
- Agrupa itens por TipoPreparo do produto
- Cria SubPedidos (um por Cozinha)
- Cria ItemPedidos associados aos SubPedidos
- Calcula totais
- Processa pagamento (se FUNDO_CONSUMO)


BUSCAR PEDIDO ATIVO DA UNIDADE:
GET /api/pedidos/unidade-consumo/{unidadeConsumoId}/ativo

Retorna:
{
  "id": 123,
  "numero": "PED-20260221-001",
  "status": "EM_ANDAMENTO",
  "statusFinanceiro": "PAGO",
  "total": 12500.00,
  "subPedidos": [
    {
      "id": 201,
      "numero": "PED-001-1",
      "status": "EM_PREPARACAO",
      "cozinha": {
        "id": 1,
        "nome": "Cozinha Principal",
        "tipo": "PRINCIPAL"
      },
      "itens": [
        {
          "produto": {
            "id": 1,
            "nome": "Muamba de Galinha",
            "preco": 8500.00
          },
          "quantidade": 1,
          "subtotal": 8500.00
        }
      ]
    },
    {
      "id": 202,
      "numero": "PED-001-2",
      "status": "PRONTO",
      "cozinha": {
        "id": 2,
        "nome": "Bar",
        "tipo": "BAR"
      },
      "itens": [...]
    }
  ]
}


FINALIZAR PEDIDO (quando todos SubPedidos ENTREGUE):
POST /api/pedidos/{id}/finalizar

Backend valida:
- Todos SubPedidos est√£o ENTREGUE
- Pedido ainda n√£o est√° FINALIZADO
- Atualiza StatusPedido para FINALIZADO


PROCESSAR PAGAMENTO:
POST /api/pagamentos
{
  "pedidoId": 123,
  "metodoPagamento": "DINHEIRO",
  "valorPago": 15000.00
}


================================================================================
8. PREPARA√á√ÉO PARA DELIVERY (SEM IMPLEMENTAR)
================================================================================

Mesmo sem implementar delivery agora, a UI deve:

‚úÖ N√£o assumir que consumo √© sempre presencial
   ‚Üí TipoUnidadeConsumo j√° tem valor VIRTUAL preparado

‚úÖ N√£o acoplar layout a mesa f√≠sica
   ‚Üí Usar "Unidade de Consumo" como termo gen√©rico

‚úÖ Usar termos neutros nos labels
   ‚Üí "Pedido", "Cliente", "Endere√ßo de Consumo"

‚úÖ Estar preparada para campos futuros:
   ‚Üí enderecoEntrega (quando TipoUnidadeConsumo = VIRTUAL)
   ‚Üí tempoEstimado (c√°lculo de rota)
   ‚Üí statusEntrega (para delivery)

‚úÖ TipoPreparo j√° tem valor ENTREGA
   ‚Üí Produtos classificados como ENTREGA ser√£o roteados diferente

Nada na UI deve impedir esse crescimento.


================================================================================
9. MUDAN√áAS RECENTES NA API (21/02/2026)
================================================================================

‚ö†Ô∏è BREAKING CHANGE - Campo disponivel REMOVIDO:

ANTES (N√ÉO USAR MAIS):
produto.disponivel ‚ùå

AGORA:
produto.ativo ‚úÖ
produto.tipoPreparo ‚úÖ (QUENTE, FRIO, BAR, BEBIDA, SOBREMESA, ENTREGA)

IMPACTO NO FRONTEND:
- Remover checkbox "Dispon√≠vel" dos formul√°rios
- Adicionar select "Tipo de Preparo" (obrigat√≥rio)
- Usar produto.ativo para mostrar status
- Disponibilidade real √© calculada dinamicamente pelo backend

Ver documento completo: RELATORIO_MUDANCAS_API_PRODUTOS.md


================================================================================
10. ESTADOS E TRANSI√á√ïES (M√ÅQUINA DE ESTADOS)
================================================================================

SUBPEDIDO (Gerenciado pela Cozinha/Bar):
CRIADO ‚Üí PENDENTE ‚Üí EM_PREPARACAO ‚Üí PRONTO ‚Üí ENTREGUE ‚úÖ
                                           ‚Üí CANCELADO ‚ùå

PEDIDO (Derivado automaticamente):
CRIADO ‚Üí EM_ANDAMENTO ‚Üí FINALIZADO ‚úÖ
                      ‚Üí CANCELADO ‚ùå

UNIDADE DE CONSUMO:
DISPONIVEL ‚Üí OCUPADA ‚Üí AGUARDANDO_PAGAMENTO ‚Üí FINALIZADA ‚Üí DISPONIVEL

STATUS FINANCEIRO (Independente):
NAO_PAGO ‚Üí PAGO ‚úÖ
        ‚Üí ESTORNADO ‚ùå


================================================================================
11. REGRAS DE VALIDA√á√ÉO (FRONTEND)
================================================================================

ANTES DE CRIAR PEDIDO:
‚úÖ UnidadeDeConsumo deve estar OCUPADA
‚úÖ Deve ter Cliente associado
‚úÖ N√£o pode ter outro Pedido ATIVO
‚úÖ Produtos devem estar ATIVOS (ativo = true)
‚úÖ Se FUNDO_CONSUMO, validar saldo suficiente

ANTES DE FINALIZAR PEDIDO:
‚úÖ Todos SubPedidos devem estar ENTREGUE
‚úÖ Pedido deve estar EM_ANDAMENTO
‚úÖ StatusFinanceiroPedido deve estar PAGO (ou p√≥s-pago)

ANTES DE CANCELAR PEDIDO:
‚úÖ Pedido n√£o pode estar FINALIZADO
‚úÖ Requer confirma√ß√£o do usu√°rio
‚úÖ Informa que todos SubPedidos ser√£o cancelados


================================================================================
12. FILOSOFIA FINAL
================================================================================

O frontend N√ÉO √© protagonista.
O DOM√çNIO √© o protagonista.

A melhor UI ser√° aquela que:
- Some quando o dom√≠nio est√° claro
- N√£o inventa comportamento
- Apenas traduz o estado real do sistema
- Reflete fielmente as entidades do backend

Se a UI parece simples,
√© porque o dom√≠nio est√° correto.


================================================================================
RESULTADO ESPERADO
================================================================================

Uma p√°gina de pedidos que:

‚úÖ Funciona para restaurante, bar, discoteca
‚úÖ Funciona com pr√© e p√≥s-pago
‚úÖ Funciona com POS por operador
‚úÖ Funciona hoje sem delivery
‚úÖ Funciona amanh√£ com delivery
‚úÖ N√£o precisa ser reescrita para escalar
‚úÖ Usa EXATAMENTE os mesmos nomes de entidades do backend
‚úÖ Respeita a m√°quina de estados do dom√≠nio
‚úÖ Reage a eventos WebSocket em tempo real

Este frontend √© parte de uma PLATAFORMA,
n√£o de um cliente espec√≠fico.


================================================================================
CHECKLIST DE IMPLEMENTA√á√ÉO
================================================================================

ESTRUTURA DE DADOS:
‚òê Criar interfaces TypeScript mapeando entidades do backend
‚òê UnidadeDeConsumo, Pedido, SubPedido, ItemPedido, Cozinha
‚òê StatusPedido, StatusSubPedido, StatusFinanceiroPedido (enums)
‚òê TipoCozinha, TipoUnidadeConsumo, TipoPagamentoPedido (enums)

CONEX√ÉO WEBSOCKET:
‚òê Implementar conex√£o STOMP com endpoint /api/ws
‚òê Subscrever em /topic/pedido/{id}
‚òê Subscrever em /topic/atendente/unidade/{id}
‚òê Tratar reconex√£o autom√°tica
‚òê Mostrar indicador de conex√£o

COMPONENTES UI:
‚òê Componente: Contexto do Consumo (UnidadeDeConsumo + Cliente + Saldo)
‚òê Componente: Pedido Ativo (Status + Total)
‚òê Componente: Lista de SubPedidos Agrupados por Cozinha
‚òê Componente: A√ß√µes Contextuais (baseadas no estado)
‚òê Componente: Alerta de SubPedido Pronto (notifica√ß√£o)

CHAMADAS API:
‚òê GET /api/unidades-consumo/{id}
‚òê GET /api/pedidos/unidade-consumo/{id}/ativo
‚òê POST /api/pedidos (criar novo pedido)
‚òê POST /api/pedidos/{id}/finalizar
‚òê POST /api/pagamentos (processar pagamento)
‚òê GET /api/produtos (listar produtos ativos com tipoPreparo)

VALIDA√á√ïES:
‚òê Validar estado antes de permitir a√ß√µes
‚òê Validar saldo de fundo antes de criar pedido pr√©-pago
‚òê Impedir finalizar pedido com SubPedido n√£o entregue
‚òê Mostrar mensagens de erro claras do backend

TESTES:
‚òê Criar pedido com m√∫ltiplos produtos (diferentes TipoPreparo)
‚òê Verificar agrupamento correto por Cozinha
‚òê Testar WebSocket: receber notifica√ß√£o de mudan√ßa de status
‚òê Testar fluxo completo: criar ‚Üí preparar ‚Üí entregar ‚Üí finalizar


================================================================================
FIM DO DOCUMENTO
================================================================================
