================================================================================
RESPOSTAS √ÄS D√öVIDAS DA EQUIPE DE FRONTEND
Sistema de Restaura√ß√£o - Integra√ß√£o Fundo de Consumo
================================================================================

DATA: 17 de Fevereiro de 2026
DESTINAT√ÅRIO: Equipe Frontend
ASSUNTO: Esclarecimentos sobre Integra√ß√£o API Fundo de Consumo

================================================================================
AN√ÅLISE DA EQUIPE (PONTOS IDENTIFICADOS)
================================================================================

A equipe identificou corretamente as seguintes diferen√ßas entre Mock e API:

1. Status: Mock usa status: 'ATIVO'|'ENCERRADO'|'EXPIRADO' ‚Üí API usa ativo: true|false
2. Datas: Mock usa dataCriacao ‚Üí API usa createdAt e updatedAt
3. Saldo inicial: No backend √© OBRIGAT√ìRIO (m√≠nimo 5.000 AOA configur√°vel)
4. Estrutura Fundo: API inclui objeto cliente completo
5. Autentica√ß√£o: JWT obrigat√≥rio em todos os endpoints


================================================================================
RESPOSTAS DETALHADAS
================================================================================

1. STATUS VS ATIVO
-------------------

‚úÖ CORRETO! A API usa apenas booleano:

- ativo: true  ‚Üí Fundo funcionando normalmente (permite todas opera√ß√µes)
- ativo: false ‚Üí Fundo encerrado (bloqueia movimenta√ß√µes)

‚ö†Ô∏è N√ÉO H√Å "EXPIRADO" NO BACKEND

Se precisarem desse estado no frontend, implementem como l√≥gica de apresenta√ß√£o.
Exemplo: verificar se h√° inatividade h√° X dias e exibir badge "Inativo h√° 90 dias".

CONVERS√ÉO NECESS√ÅRIA:
Mock                  ‚Üí API
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
status: 'ATIVO'      ‚Üí ativo: true
status: 'ENCERRADO'  ‚Üí ativo: false
status: 'EXPIRADO'   ‚Üí ativo: false (+ l√≥gica frontend)


-------------------
2. DATAS: dataCriacao vs createdAt/updatedAt
-------------------

‚úÖ CORRETO! API retorna campos diferentes:

API Backend:
- createdAt  ‚Üí Data de cria√ß√£o (ISO 8601: "2026-02-17T10:00:00")
- updatedAt  ‚Üí √öltima atualiza√ß√£o (ISO 8601: "2026-02-17T14:30:00")

‚ö†Ô∏è N√ÉO H√Å "dataCriacao" NO BACKEND

CONVERS√ÉO NECESS√ÅRIA:
Mock                 ‚Üí API
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
dataCriacao         ‚Üí createdAt
(n√£o existe)        ‚Üí updatedAt (novo)

EXEMPLO DE CONVERS√ÉO:
// Mock
const fundo = { dataCriacao: '2026-02-17' };

// API
const fundo = { 
  createdAt: '2026-02-17T10:00:00',
  updatedAt: '2026-02-17T14:30:00'
};

// No componente
const dataFormatada = new Date(fundo.createdAt).toLocaleDateString('pt-AO');


-------------------
3. SALDO INICIAL OBRIGAT√ìRIO (CR√çTICO!)
-------------------

‚úÖ CR√çTICO! Backend exige saldo m√≠nimo:

REGRAS:
- Valor m√≠nimo: 5.000 AOA (configur√°vel no backend)
- Campo saldoInicial √© OBRIGAT√ìRIO ao criar fundo
- Backend rejeita com erro 400 se saldoInicial < 5000

FLUXO CORRETO:

PASSO 1: Consultar valor m√≠nimo ANTES de exibir formul√°rio
GET /api/fundos/config/valor-minimo

Response:
{
  "status": 200,
  "data": 5000.00
}

PASSO 2: Validar no frontend
if (saldoInicial < valorMinimo) {
  erro = `Saldo inicial deve ser no m√≠nimo ${valorMinimo.toFixed(2)} AOA`;
}

PASSO 3: Enviar para API
POST /api/fundos
{
  "clienteId": 10,
  "saldoInicial": 10000.00,
  "observacoes": "Carga inicial via dinheiro"
}

ERRO SE N√ÉO RESPEITAR:
{
  "status": 400,
  "message": "Saldo inicial deve ser no m√≠nimo 5000.00 AOA. Valor informado: 3000.00 AOA"
}


-------------------
4. ESTRUTURA DO FUNDO
-------------------

‚úÖ CORRETO! API retorna cliente completo (n√£o apenas ID):

ESTRUTURA COMPLETA DA API:
{
  "id": 1,
  "cliente": {                        // Objeto completo (n√£o apenas ID!)
    "id": 10,
    "nome": "Jo√£o Pedro Afonso",
    "telefone": "+244925813939",
    "telefoneVerificado": true,
    "ativo": true,
    "tipoUsuario": "CLIENTE"
  },
  "saldoAtual": 50000.00,
  "ativo": true,                      // Booleano (n√£o string!)
  "createdAt": "2026-02-17T10:00:00",
  "updatedAt": "2026-02-17T14:30:00",
  "version": 5                        // Controle de concorr√™ncia
}

CONVERS√ÉO NECESS√ÅRIA:
Mock                    ‚Üí API
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
clienteId: 10          ‚Üí cliente: { id: 10, nome: "...", ... }
status: 'ATIVO'        ‚Üí ativo: true
dataCriacao: '...'     ‚Üí createdAt: '...'
(n√£o existe)           ‚Üí updatedAt: '...'
(n√£o existe)           ‚Üí version: 5


================================================================================
RESPOSTAS √ÄS 3 PERGUNTAS
================================================================================

PERGUNTA 1: J√° existe sistema de autentica√ß√£o no frontend?
-----------------------------------------------------------

RESPOSTA: Depende do que j√° existe no projeto.

O BACKEND J√Å EST√Å PRONTO COM:
‚úì JWT authentication
‚úì Endpoints de autentica√ß√£o dispon√≠veis
‚úì Token com validade de 24 horas
‚úì Roles: ADMIN, ATENDENTE, CLIENTE

SE O FRONTEND AINDA N√ÉO TEM, VOC√äS PRECISAM IMPLEMENTAR:

1. Armazenar token
   sessionStorage.setItem('token', accessToken);  // N√ÉO usar localStorage!

2. Incluir token em TODAS as requisi√ß√µes
   Authorization: Bearer {token}

3. Interceptor axios/fetch
   axios.interceptors.request.use(config => {
     const token = sessionStorage.getItem('token');
     if (token) {
       config.headers.Authorization = `Bearer ${token}`;
     }
     return config;
   });

4. Redirecionar para login se receber 401
   axios.interceptors.response.use(
     response => response,
     error => {
       if (error.response?.status === 401) {
         sessionStorage.removeItem('token');
         router.push('/login');
       }
       return Promise.reject(error);
     }
   );

5. Verificar expira√ß√£o do token
   Token expira em 24 horas (86400 segundos)


PERGUNTA 2: Qual o endpoint de login? J√° est√° dispon√≠vel?
----------------------------------------------------------

RESPOSTA: ‚úÖ SIM! O backend tem 2 sistemas de autentica√ß√£o:


A) LOGIN ADMINISTRATIVO (Para Painel Admin)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Endpoint: POST /api/auth/login
Content-Type: application/json

Request Body:
{
  "username": "admin",
  "password": "senha123"
}

Response 200:
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expiresIn": 86400
}

Response 401 (Credenciais inv√°lidas):
{
  "status": 401,
  "message": "Credenciais inv√°lidas"
}

USAR PARA: Painel administrativo onde atendentes/admins fazem login


B) LOGIN CLIENTE (Via OTP - Para App Mobile/Cliente)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

PASSO 1: Solicitar OTP
Endpoint: POST /api/auth/solicitar-otp
Content-Type: application/json

Request:
{
  "telefone": "925813939"
}

Response 200:
{
  "status": 200,
  "message": "OTP enviado com sucesso"
}

NOTA: OTP √© enviado via SMS (em dev aparece no log do backend)
OTP v√°lido por 30 minutos


PASSO 2: Validar OTP (Retorna JWT)
Endpoint: POST /api/auth/validar-otp
Content-Type: application/json

Request:
{
  "telefone": "925813939",
  "codigo": "1234"
}

Response 200:
{
  "status": 200,
  "data": {
    "id": 10,
    "nome": "Jo√£o Pedro Afonso",
    "telefone": "+244925813939",
    "telefoneVerificado": true,
    "accessToken": "eyJhbGci...",
    "expiresIn": 86400
  }
}

Response 400 (OTP inv√°lido):
{
  "status": 400,
  "message": "C√≥digo OTP inv√°lido ou expirado"
}

USAR PARA: App do cliente onde ele se autentica com telefone + OTP


QUAL USAR?
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
- Painel Administrativo ‚Üí POST /api/auth/login (username/password)
- App do Cliente        ‚Üí POST /api/auth/solicitar-otp + POST /api/auth/validar-otp


PERGUNTA 3: Manter mock como fallback ou substituir completamente?
-------------------------------------------------------------------

RECOMENDA√á√ÉO: ‚ö†Ô∏è SUBSTITUIR COMPLETAMENTE

Mas se precisarem transi√ß√£o gradual:


ESTRAT√âGIA 1: Substitui√ß√£o Completa (RECOMENDADO)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

1. Remover completamente c√≥digo mockado
2. Implementar integra√ß√£o com API real
3. Usar vari√°veis de ambiente para configura√ß√£o

// .env
VITE_API_URL=http://localhost:8080/api

// api.config.ts
export const API_CONFIG = {
  BASE_URL: import.meta.env.VITE_API_URL || 'http://localhost:8080/api',
  TIMEOUT: 30000
};


ESTRAT√âGIA 2: Transi√ß√£o Gradual (SE NECESS√ÅRIO)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// .env
VITE_API_URL=http://localhost:8080/api
VITE_USE_MOCK=false

// api.config.ts
const API_CONFIG = {
  BASE_URL: import.meta.env.VITE_API_URL || 'http://localhost:8080/api',
  USE_MOCK: import.meta.env.VITE_USE_MOCK === 'true',
  TIMEOUT: 30000
};

// fundoService.ts
export async function buscarFundo(clienteId: number) {
  if (API_CONFIG.USE_MOCK) {
    return mockFundoService.buscarFundo(clienteId);  // Mock
  }
  
  const response = await api.get(`/fundos/cliente/${clienteId}`);  // API
  return response.data.data;
}

‚ö†Ô∏è REMOVER MOCK AP√ìS INTEGRA√á√ÉO COMPLETA!


MOTIVOS PARA N√ÉO MANTER MOCK PERMANENTEMENTE:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚ùå Duplica√ß√£o de c√≥digo (2x manuten√ß√£o)
‚ùå Risco de diverg√™ncia entre mock e API real
‚ùå Dificulta debug (n√£o se sabe se erro √© do mock ou da API)
‚ùå Aumenta complexidade desnecess√°ria
‚ùå Testes podem passar com mock mas falhar com API real


ALTERNATIVA PARA TESTES:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Use Mock Service Worker (MSW) para testes e2e:

npm install -D msw

// mocks/handlers.ts
export const handlers = [
  rest.get('/api/fundos/cliente/:id', (req, res, ctx) => {
    return res(ctx.json({ /* mock data */ }));
  })
];

Isso mant√©m testes isolados SEM poluir c√≥digo de produ√ß√£o.


================================================================================
CHECKLIST DE INTEGRA√á√ÉO
================================================================================

Para facilitar, aqui est√° a ordem recomendada:


‚òê FASE 1: AUTENTICA√á√ÉO
   ‚òê 1.1. Implementar servi√ßo de autentica√ß√£o
      ‚òê Login (POST /api/auth/login)
      ‚òê Armazenar token no sessionStorage
      ‚òê Fun√ß√£o logout (limpar sessionStorage)
   
   ‚òê 1.2. Configurar interceptor HTTP
      ‚òê Adicionar Bearer token em todas requisi√ß√µes
      ‚òê Redirecionar para login em erro 401
      ‚òê Implementar refresh de token (se aplic√°vel)
   
   ‚òê 1.3. Testar autentica√ß√£o
      ‚òê Fazer login com admin/senha123
      ‚òê Verificar token armazenado
      ‚òê Verificar header Authorization em requisi√ß√µes
      ‚òê Testar expira√ß√£o (for√ßar 401)


‚òê FASE 2: CONFIGURA√á√ÉO INICIAL
   ‚òê 2.1. Consultar valor m√≠nimo
      ‚òê GET /api/fundos/config/valor-minimo
      ‚òê Armazenar em estado global/context
      ‚òê Exibir no formul√°rio de cria√ß√£o
   
   ‚òê 2.2. Configurar valida√ß√µes
      ‚òê Validar saldoInicial >= valorMinimo
      ‚òê Validar formato de valores (2 casas decimais)
      ‚òê Validar clienteId num√©rico


‚òê FASE 3: CRIA√á√ÉO DE FUNDO
   ‚òê 3.1. Implementar formul√°rio
      ‚òê Campo clienteId (sele√ß√£o)
      ‚òê Campo saldoInicial (input number)
      ‚òê Campo observacoes (textarea opcional)
      ‚òê Exibir valor m√≠nimo din√¢mico
   
   ‚òê 3.2. Implementar chamada API
      ‚òê POST /api/fundos com clienteId + saldoInicial + observacoes
      ‚òê Tratar sucesso (exibir fundo criado)
      ‚òê Tratar erros (400, 404, 401, 500)
   
   ‚òê 3.3. Testar cria√ß√£o
      ‚òê Criar com saldo >= 5.000 AOA (sucesso)
      ‚òê Tentar criar com saldo < 5.000 AOA (erro 400)
      ‚òê Verificar transa√ß√£o CREDITO criada


‚òê FASE 4: BUSCA DE FUNDO
   ‚òê 4.1. Implementar busca
      ‚òê GET /api/fundos/cliente/{id}
      ‚òê Exibir dados do fundo (saldo, status, datas)
      ‚òê Exibir dados do cliente completos
   
   ‚òê 4.2. Tratar estados
      ‚òê Loading durante requisi√ß√£o
      ‚òê Fundo encontrado (exibir dados)
      ‚òê Fundo n√£o encontrado (404)
      ‚òê Erro de rede (500)


‚òê FASE 5: RECARGA DE FUNDO
   ‚òê 5.1. Implementar recarga GPO
      ‚òê POST /api/fundos/{id}/recarregar (GPO)
      ‚òê Redirecionar para urlPagamento
      ‚òê Implementar polling para verificar confirma√ß√£o
   
   ‚òê 5.2. Implementar recarga REF
      ‚òê POST /api/fundos/{id}/recarregar (REF)
      ‚òê Exibir entidade + refer√™ncia
      ‚òê Implementar polling (pode demorar horas)
      ‚òê Exibir status "Aguardando confirma√ß√£o"


‚òê FASE 6: HIST√ìRICO DE TRANSA√á√ïES
   ‚òê 6.1. Implementar listagem
      ‚òê GET /api/fundos/{id}/transacoes
      ‚òê Exibir em tabela/lista ordenada (mais recente primeiro)
      ‚òê Cores: verde (CREDITO/ESTORNO), vermelho (DEBITO)
   
   ‚òê 6.2. Implementar filtros
      ‚òê Por tipo (CREDITO, DEBITO, ESTORNO)
      ‚òê Por per√≠odo (data in√≠cio/fim)
      ‚òê Por valor (m√≠nimo/m√°ximo)


‚òê FASE 7: TESTES INTEGRADOS
   ‚òê 7.1. Fluxo completo
      ‚òê Login ‚Üí Consultar valor m√≠nimo ‚Üí Criar fundo ‚Üí Buscar fundo
   
   ‚òê 7.2. Cen√°rios de erro
      ‚òê Token expirado (401)
      ‚òê Saldo insuficiente (400)
      ‚òê Fundo n√£o encontrado (404)
      ‚òê Gateway indispon√≠vel (500)


‚òê FASE 8: REFATORA√á√ÉO E LIMPEZA
   ‚òê 8.1. Remover c√≥digo mockado
      ‚òê Deletar arquivos de mock
      ‚òê Remover flags USE_MOCK
      ‚òê Limpar imports n√£o utilizados
   
   ‚òê 8.2. Documentar c√≥digo
      ‚òê Adicionar JSDoc nos servi√ßos
      ‚òê Documentar interfaces TypeScript
      ‚òê Adicionar coment√°rios em l√≥gica complexa


================================================================================
INFORMA√á√ïES ADICIONAIS
================================================================================

ESTRUTURA DE ERROS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Todos os erros seguem o formato padr√£o:

{
  "status": 400,
  "message": "Mensagem de erro leg√≠vel",
  "timestamp": "2026-02-17T15:30:00",
  "path": "/api/fundos"
}

C√≥digos HTTP:
- 200 OK              ‚Üí Sucesso (GET)
- 201 Created         ‚Üí Recurso criado (POST)
- 400 Bad Request     ‚Üí Valida√ß√£o falhou
- 401 Unauthorized    ‚Üí Token inv√°lido/ausente
- 403 Forbidden       ‚Üí Sem permiss√£o
- 404 Not Found       ‚Üí Recurso n√£o encontrado
- 409 Conflict        ‚Üí Conflito (ex: fundo j√° existe)
- 500 Internal Error  ‚Üí Erro no servidor


PERMISS√ïES POR ROLE
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

ADMIN:
‚úì Acesso total a todos os endpoints
‚úì Criar fundos para qualquer cliente
‚úì Recarregar fundos
‚úì Consultar qualquer fundo
‚úì Ver hist√≥rico completo

ATENDENTE:
‚úì Consultar fundos
‚úì Ver hist√≥rico
‚úó N√ÉO pode recarregar fundos
‚úó N√ÉO pode criar fundos

CLIENTE:
‚úì Ver pr√≥prio saldo
‚úì Ver pr√≥prio hist√≥rico
‚úó N√ÉO pode recarregar (somente via gateway)
‚úó N√ÉO pode ver outros clientes


CORS
‚îÄ‚îÄ‚îÄ‚îÄ

Backend j√° est√° configurado para aceitar requisi√ß√µes de:
- http://localhost:3000
- http://localhost:4200

Se precisar adicionar outra origem, solicitar no backend.


TIMEOUT
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Recomendado: 30 segundos

axios.create({
  timeout: 30000
});


RETRY COM EXPONENTIAL BACKOFF
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Implementar para erros 5xx (servidor):

async function fetchComRetry(url, options, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await fetch(url, options);
    } catch (error) {
      if (error.status >= 500 && i < maxRetries - 1) {
        const delay = Math.pow(2, i) * 1000; // 1s, 2s, 4s
        await new Promise(resolve => setTimeout(resolve, delay));
        continue;
      }
      throw error;
    }
  }
}


FORMATA√á√ÉO DE VALORES MONET√ÅRIOS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// Formato Angolano (AOA)
const formatarMoeda = (valor: number) => {
  return new Intl.NumberFormat('pt-AO', {
    style: 'currency',
    currency: 'AOA',
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }).format(valor);
};

// Resultado: "5.000,00 AOA"


FORMATA√á√ÉO DE DATAS
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// ISO 8601 para Date
const data = new Date('2026-02-17T10:00:00');

// Formato curto
data.toLocaleDateString('pt-AO');  // "17/02/2026"

// Formato longo
data.toLocaleString('pt-AO');      // "17/02/2026, 10:00:00"

// Personalizado
new Intl.DateTimeFormat('pt-AO', {
  day: '2-digit',
  month: 'short',
  year: 'numeric',
  hour: '2-digit',
  minute: '2-digit'
}).format(data);  // "17 de fev. de 2026, 10:00"


NOTIFICA√á√ïES VIA WEBSOCKET (FUTURO)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

Backend suporta WebSocket em: ws://localhost:8080/ws

Para receber notifica√ß√µes em tempo real quando pagamento for confirmado:

const socket = new WebSocket('ws://localhost:8080/ws');

socket.onmessage = (event) => {
  const message = JSON.parse(event.data);
  if (message.type === 'PAGAMENTO_CONFIRMADO') {
    // Atualizar saldo
  }
};

‚ö†Ô∏è Implementar posteriormente, n√£o √© cr√≠tico para MVP


================================================================================
D√öVIDAS FREQUENTES (FAQ)
================================================================================

Q1: Posso criar fundo com saldo zero?
A1: N√ÉO. Saldo m√≠nimo √© 5.000 AOA (configur√°vel no backend).

Q2: O que acontece se enviar valor abaixo do m√≠nimo?
A2: Erro 400 com mensagem: "Saldo inicial deve ser no m√≠nimo 5000.00 AOA"

Q3: Transa√ß√£o de carga inicial √© criada automaticamente?
A3: SIM. Backend cria TransacaoFundo tipo CREDITO ao criar fundo.

Q4: Cliente pode ter m√∫ltiplos fundos?
A4: N√ÉO. Um cliente = Um fundo ativo por vez.

Q5: Como encerrar um fundo?
A5: N√£o h√° endpoint p√∫blico. Apenas ADMIN pode encerrar via opera√ß√£o interna.

Q6: Fundo encerrado pode ser reativado?
A6: N√ÉO. Precisa criar novo fundo.

Q7: Token JWT expira?
A7: SIM. Validade: 24 horas (86400 segundos).

Q8: O que fazer quando token expirar?
A8: Redirecionar para tela de login.

Q9: Posso usar localStorage para token?
A9: N√ÉO RECOMENDADO. Use sessionStorage (mais seguro contra XSS).

Q10: Valores monet√°rios precisam ter 2 casas decimais?
A10: SIM. Backend valida precision 10, scale 2.

Q11: Endpoint de recarga √© s√≠ncrono ou ass√≠ncrono?
A11: ASS√çNCRONO. Retorna Pagamento pendente, usar polling para verificar.

Q12: Quanto tempo demora confirma√ß√£o REF?
A12: De 5 minutos a 24 horas (depende do banco).

Q13: GPO √© instant√¢neo?
A13: SIM, mas ainda requer callback. Polling recomendado (mais r√°pido que REF).

Q14: Como sei se pagamento foi confirmado?
A14: Consultar saldo periodicamente (GET /api/fundos/cliente/{id}).

Q15: Posso filtrar transa√ß√µes por data?
A15: Atualmente endpoint retorna todas. Implementar filtro no frontend.


================================================================================
CONTATO E SUPORTE
================================================================================

Para d√∫vidas adicionais ou problemas durante integra√ß√£o:

Backend Team:
- Documenta√ß√£o API: http://localhost:8080/swagger-ui.html
- Arquivo Postman: API_EXAMPLES.md (raiz do projeto)

PR√ìXIMOS PASSOS:
1. Revisar este documento com a equipe
2. Definir prioridades de implementa√ß√£o
3. Iniciar FASE 1 (Autentica√ß√£o)
4. Reuni√£o de acompanhamento em 3 dias

BOA INTEGRA√á√ÉO! üöÄ

================================================================================
√öLTIMA ATUALIZA√á√ÉO: 17 de Fevereiro de 2026
VERS√ÉO DO DOCUMENTO: 1.0
================================================================================
