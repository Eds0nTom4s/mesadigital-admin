================================================================================
PLANO DE A√á√ÉO - INTEGRA√á√ÉO FRONTEND/BACKEND
================================================================================

Data: 22 de fevereiro de 2026
Baseado em: RESPOSTA_BACKEND_INTEGRACAO.txt

Este documento organiza todas as a√ß√µes necess√°rias para completar a integra√ß√£o
com base nas respostas detalhadas da equipe backend.

================================================================================
SE√á√ÉO 1: CORRE√á√ïES CR√çTICAS (FAZER IMEDIATAMENTE)
================================================================================

‚úÖ 1.1 - MIGRA√á√ÉO FUNDO_CONSUMO ‚Üí PRE_PAGO
Status: J√Å CORRIGIDO
Arquivos atualizados:
- ModalNovoPedido.vue
- pedido.types.js
- Documenta√ß√£o

A√ß√£o: Nenhuma (j√° implementado)


üî¥ 1.2 - VALIDA√á√ÉO DE CLIENTE VINCULADO ANTES DE CRIAR PEDIDO PRE_PAGO
Status: PENDENTE
Problema: Frontend n√£o valida se unidade tem cliente antes de mostrar PRE_PAGO

A√ß√£o necess√°ria:
- Em ModalNovoPedido.vue, ao carregar modal:
  * Verificar se props.unidade tem cliente vinculado
  * Se N√ÉO tiver cliente:
    - DESABILITAR op√ß√£o PRE_PAGO no radio button
    - Mostrar tooltip: "Vincule um cliente √† unidade primeiro"
    - For√ßar tipoPagamento para POS_PAGO (se usu√°rio for GERENTE/ADMIN)
    - OU bloquear cria√ß√£o de pedido com mensagem clara

Backend retorna erro 400 se tentar PRE_PAGO sem cliente:
"Unidade de consumo deve ter cliente vinculado para pagamento PRE_PAGO"

Melhor UX: Validar ANTES no frontend para evitar erro desnecess√°rio.


üî¥ 1.3 - PAYLOAD DE CRIA√á√ÉO DE PEDIDO
Status: VERIFICAR
Situa√ß√£o atual: Payload enviado est√° CORRETO segundo backend

Payload atual (ModalNovoPedido.vue linha 329-335):
{
  unidadeConsumoId: props.unidade.id,
  tipoPagamento: tipoPagamento.value,
  itens: carrinho.value.map(item => ({
    produtoId: item.produtoId,
    quantidade: item.quantidade
  }))
}

Backend esperado (RESPOSTA se√ß√£o 1.1a):
{
  unidadeConsumoId: Long,
  tipoPagamento: "PRE_PAGO" ou "POS_PAGO",
  itens: [
    {
      produtoId: Long,
      quantidade: Integer,
      observacoes: String (opcional)
    }
  ]
}

‚úÖ Payload est√° CORRETO!

POR√âM, o erro "Valor de d√©bito deve ser maior que zero" pode ser causado por:
a) Produtos com pre√ßo = 0 no banco
b) Produtos inativos sendo enviados
c) Quantidade = 0 sendo enviada
d) Bug no backend (improv√°vel)

A√ß√£o necess√°ria:
- Adicionar console.log do carrinho completo antes de criar pedido
- Verificar se quantidade > 0
- Adicionar campo observacoes (opcional) ao payload


üî¥ 1.4 - ADICIONAR OBSERVA√á√ïES AO ITEM
Status: PENDENTE
Problema: Carrinho n√£o tem campo observacoes, mas backend aceita

A√ß√£o necess√°ria:
- Em ModalNovoPedido.vue:
  * Adicionar campo "observacoes" opcional em cada item do carrinho
  * Mostrar textarea quando usu√°rio clicar em "Adicionar observa√ß√£o"
  * Limite: 500 caracteres (backend valida)
  * N√£o aceita emojis (backend remove automaticamente)

Enviar no payload:
itens: carrinho.value.map(item => ({
  produtoId: item.produtoId,
  quantidade: item.quantidade,
  observacoes: item.observacoes || undefined // s√≥ enviar se tiver
}))


================================================================================
SE√á√ÉO 2: IMPLEMENTA√á√ïES DE SEGURAN√áA E VALIDA√á√ïES
================================================================================

üî¥ 2.1 - VALIDAR PERMISS√ïES PARA POS_PAGO
Status: PENDENTE
Problema: Qualquer usu√°rio pode selecionar POS_PAGO na UI

Backend s√≥ aceita POS_PAGO de: ADMIN e GERENTE
Retorna 403 se ATENDENTE tentar.

A√ß√£o necess√°ria:
- Em ModalNovoPedido.vue:
  * Importar authStore
  * Verificar role do usu√°rio logado
  * Se role === 'ATENDENTE':
    - DESABILITAR op√ß√£o POS_PAGO no radio button
    - For√ßar tipoPagamento para PRE_PAGO
    - Mostrar tooltip: "Apenas Gerente pode usar P√≥s-Pago"

Exemplo:
const authStore = useAuthStore()
const podeUsarPosPago = computed(() => {
  return ['ADMIN', 'GERENTE'].includes(authStore.usuario?.role)
})


üî¥ 2.2 - CONSULTAR STATUS GLOBAL DE P√ìS-PAGO
Status: PENDENTE
Problema: Frontend n√£o verifica se p√≥s-pago est√° ativo no sistema

Backend pode DESATIVAR p√≥s-pago globalmente via:
POST /api/configuracao-financeira/pos-pago/desativar

Quando desativado, retorna 403: "Pagamento p√≥s-pago est√° temporariamente 
desativado. Use PRE_PAGO ou aguarde libera√ß√£o"

A√ß√£o necess√°ria:
- Criar configuracaoFinanceiraService.js:
  * GET /api/configuracao-financeira
  * Retorna: { posPagoAtivo: true/false, ... }

- Em ModalNovoPedido.vue:
  * Ao abrir modal (onMounted):
    - Consultar configura√ß√£o financeira
    - Se posPagoAtivo = false:
      - DESABILITAR op√ß√£o POS_PAGO
      - Tooltip: "P√≥s-pago temporariamente indispon√≠vel"

- N√ÉO fazer polling, consultar apenas ao abrir modal


üî¥ 2.3 - VALIDAR QUANTIDADE M√ÅXIMA POR ITEM
Status: PENDENTE
Problema: N√£o h√° valida√ß√£o de quantidade no frontend

Backend limita: 1 <= quantidade <= 999

A√ß√£o necess√°ria:
- Em ModalNovoPedido.vue:
  * Input de quantidade deve ter:
    - min="1"
    - max="999"
    - type="number"
  * Validar antes de adicionar ao carrinho
  * Se quantidade > 999: mostrar erro


üî¥ 2.4 - VALIDAR PRODUTOS INATIVOS
Status: PENDENTE
Problema: Frontend pode estar mostrando produtos inativos

Backend rejeita produtos com ativo=false:
Erro 400: "Produto {nome} est√° inativo e n√£o pode ser adicionado ao pedido"

A√ß√£o necess√°ria:
- Em lista de produtos:
  * Filtrar apenas produtos com ativo = true
  * Ou desabilitar bot√£o "Adicionar" se inativo
  * Mostrar badge "Indispon√≠vel" se inativo


================================================================================
SE√á√ÉO 3: CONTROLE DE CONCORR√äNCIA E VERSIONAMENTO
================================================================================

üî¥ 3.1 - IMPLEMENTAR VERSIONAMENTO EM ATUALIZA√á√ïES
Status: PENDENTE (mas arquitetura j√° criada)
Situa√ß√£o: J√° temos pedido.store.js com suporte a versionamento

Backend usa campo "version" no body (N√ÉO header If-Match):
- Ao atualizar pedido, enviar: { version: 3, campo: "valor" }
- Se version desatualizada, retorna 409 Conflict

A√ß√£o necess√°ria:
- Usar a arquitetura j√° criada em src/store/pedido.store.js
- OU adaptar pedidosBalcaoService.js para incluir version nos PUTs
- Tratar erro 409:
  * Fazer GET do pedido atualizado
  * Avisar usu√°rio: "Pedido foi modificado por outro usu√°rio"
  * Recarregar dados


üî¥ 3.2 - ADICIONAR RETRY AUTOM√ÅTICO EM 409
Status: PENDENTE
Problema: Sistema n√£o retenta automaticamente em conflitos

Backend retorna 409 quando version √© antiga.

A√ß√£o necess√°ria:
- J√° temos concurrency.helper.js com ConflictResolver
- Integrar com pedidosBalcaoService:
  * Detectar erro 409
  * Fazer GET do pedido
  * Aplicar estrat√©gia de merge (se aplic√°vel)
  * Tentar novamente automaticamente (m√°ximo 3 tentativas)


================================================================================
SE√á√ÉO 4: WEBSOCKET E TEMPO REAL
================================================================================

üî¥ 4.1 - IMPLEMENTAR CONEX√ÉO WEBSOCKET
Status: PARCIALMENTE IMPLEMENTADO
Situa√ß√£o: J√° temos useWebSocket.js e websocket.js store

Backend WebSocket:
- URL DEV: ws://localhost:8080/ws
- URL PROD: wss://api.restaurante.com/ws
- Protocolo: STOMP sobre WebSocket
- Autentica√ß√£o: Token JWT no header Authorization

A√ß√£o necess√°ria:
- Atualizar useWebSocket.js:
  * Configurar URL correta do backend
  * Enviar token JWT no handshake:
    - Header: Authorization: Bearer {token}
    - OU query param: ?token={token}

Exemplo (SockJS + Stomp.js):
const socket = new SockJS('ws://localhost:8080/ws?token=' + authStore.token)
const stompClient = Stomp.over(socket)


üî¥ 4.2 - ASSINAR T√ìPICOS CORRETOS
Status: PENDENTE
Problema: N√£o sab√≠amos os t√≥picos exatos do backend

Backend t√≥picos dispon√≠veis:
- /topic/pedido/{pedidoId} - Atualiza√ß√µes de UM pedido espec√≠fico
- /topic/unidade/{unidadeId} - Atualiza√ß√µes de TODOS pedidos de uma unidade
- /topic/pedidos - Atualiza√ß√µes de TODOS pedidos (apenas ADMIN)

A√ß√£o necess√°ria:
- Em PedidosBalcaoView.vue:
  * Assinar /topic/unidade/{unidadeId} da unidade selecionada
  * Ao receber evento:
    - PEDIDO_CRIADO: adicionar √† lista
    - PEDIDO_ATUALIZADO: atualizar na lista
    - STATUS_ALTERADO: atualizar status visual
    - PEDIDO_PRONTO: mostrar notifica√ß√£o sonora


üî¥ 4.3 - TRATAR EVENTOS WEBSOCKET
Status: PENDENTE
Problema: N√£o sab√≠amos estrutura dos eventos

Backend envia eventos com estrutura:
{
  "evento": "PEDIDO_ATUALIZADO",
  "timestamp": "2026-02-22T15:30:00",
  "pedido": { ...pedido completo atualizado... },
  "version": 5,
  "alteradoPor": "Maria Atendente"
}

A√ß√£o necess√°ria:
- Em websocket.js store ou usePedidoWebSocket.js:
  * Ao receber evento:
    - Extrair pedido do payload
    - Atualizar store local (substituir objeto completo)
    - Atualizar version
    - Mostrar notifica√ß√£o visual se relevante

Eventos a tratar:
- PEDIDO_CRIADO
- PEDIDO_ATUALIZADO
- ITEM_ADICIONADO
- ITEM_REMOVIDO
- STATUS_ALTERADO
- SUBPEDIDO_ATUALIZADO
- PEDIDO_PRONTO (mostrar alerta sonoro)
- PEDIDO_FINALIZADO


üî¥ 4.4 - IMPLEMENTAR RECONEX√ÉO AUTOM√ÅTICA
Status: PENDENTE
Problema: Se conex√£o cair, n√£o reconecta

Backend N√ÉO guarda eventos perdidos durante desconex√£o.

A√ß√£o necess√°ria:
- Em useWebSocket.js:
  * Detectar desconex√£o (evento onClose)
  * Implementar retry com backoff exponencial:
    - 1¬™ tentativa: 1 segundo depois
    - 2¬™ tentativa: 2 segundos
    - 3¬™ tentativa: 4 segundos
    - 4¬™ tentativa: 8 segundos
    - M√°ximo: 30 segundos
  * Ap√≥s reconectar:
    - Fazer GET dos pedidos ativos
    - Reassinar t√≥picos
  * Mostrar indicador visual de "desconectado"


================================================================================
SE√á√ÉO 5: MELHORIAS DE UX E FEEDBACK
================================================================================

üî¥ 5.1 - MOSTRAR DADOS DO FUNDO AP√ìS CRIA√á√ÉO
Status: PENDENTE
Problema: N√£o exibimos saldo atualizado ap√≥s d√©bito

Backend retorna no response de cria√ß√£o de pedido PRE_PAGO:
{
  ...,
  "unidadeConsumo": {
    "cliente": {
      "fundoConsumo": {
        "saldoAnterior": 10000.00,
        "saldoAtual": 4500.00,
        "valorDebitado": 5500.00
      }
    }
  },
  "transacaoFundoId": 891
}

A√ß√£o necess√°ria:
- Ap√≥s criar pedido PRE_PAGO:
  * Extrair dados do fundo do response
  * Mostrar toast/notifica√ß√£o:
    "Pedido criado! Debitado: 55,00 Kz | Saldo: 45,00 Kz"
  * Atualizar fundoConsumo local com novo saldo


üî¥ 5.2 - MOSTRAR PROGRESSO DOS SUBPEDIDOS
Status: PENDENTE (OPCIONAL)
Problema: Usu√°rio n√£o v√™ status individual por cozinha

Backend cria subpedidos automaticamente por TipoPreparo:
- QUENTE (Cozinha Principal)
- FRIO (Cozinha Fria)
- BAR (Bar/Cafeteria)

Cada subpedido tem status independente:
- PENDENTE ‚Üí RECEBIDO ‚Üí EM_PREPARACAO ‚Üí PRONTO ‚Üí ENTREGUE

A√ß√£o necess√°ria (OPCIONAL):
- Criar componente SubPedidosProgress.vue
- Exibir cards por cozinha:
  * BAR: ‚úÖ PRONTO (2 itens)
  * COZINHA: üîÑ EM_PREPARACAO (3 itens)
- Usar √≠cones/cores para status


üî¥ 5.3 - AUDIO NOTIFICATION PARA PEDIDO PRONTO
Status: PENDENTE
Problema: Gar√ßom n√£o √© alertado quando pedido fica pronto

Backend envia evento PEDIDO_PRONTO via WebSocket quando TODOS subpedidos 
ficam PRONTO.

A√ß√£o necess√°ria:
- J√° temos src/utils/audio.js e public/sounds/
- Ao receber evento PEDIDO_PRONTO:
  * Tocar som de notifica√ß√£o
  * Mostrar alerta visual destacado
  * Vibrar (se mobile)

Exemplo:
import { playNotificationSound } from '@/utils/audio'

socket.on('PEDIDO_PRONTO', (event) => {
  playNotificationSound()
  notificationStore.sucesso('Pedido pronto para retirada!', { timeout: 10000 })
})


üî¥ 5.4 - MENSAGENS DE ERRO AMIG√ÅVEIS
Status: PARCIAL
Problema: Alguns erros mostram mensagens t√©cnicas

Backend retorna mensagens em portugu√™s no campo "message", mas algumas podem
ser muito t√©cnicas.

A√ß√£o necess√°ria:
- Criar dicion√°rio de erros:
  * Mapear mensagens do backend para mensagens amig√°veis
  * Exemplo:
    Backend: "Saldo insuficiente no fundo de consumo. Saldo atual: 2.500,00..."
    Frontend: "Saldo insuficiente! Faltam 25,00 Kz. Deseja recarregar?"

- Para erros com objeto "detalhe":
  * Usar dados do detalhe para construir mensagem rica
  * Exemplo limite p√≥s-pago:
    "Limite excedido! Dispon√≠vel: 5.000,00 Kz"


================================================================================
SE√á√ÉO 6: CORRE√á√ïES EM SERVI√áOS E STORES
================================================================================

üî¥ 6.1 - ATUALIZAR pedidosBalcaoService.js
Status: PENDENTE
Problema: Coment√°rios ainda mencionam FUNDO_CONSUMO

A√ß√£o necess√°ria:
- Em pedidosBalcaoService.js:
  * Linha 23: Trocar "@param {string} dados.tipoPagamento - FUNDO_CONSUMO (default) ou POS_PAGO"
  * Para: "@param {string} dados.tipoPagamento - PRE_PAGO ou POS_PAGO"
  * Linha 25: Trocar "Processa pagamento (se FUNDO_CONSUMO)"
  * Para: "Processa pagamento (se PRE_PAGO - d√©bito imediato)"


üî¥ 6.2 - ADICIONAR ENDPOINT DE CONFIRMAR PAGAMENTO POS_PAGO
Status: PENDENTE
Problema: N√£o temos fun√ß√£o para fechar conta p√≥s-paga

Backend endpoint:
PUT /api/pedidos/{pedidoId}/confirmar-pagamento

Body:
{
  "formaPagamento": "DINHEIRO" | "CARTAO_DEBITO" | "CARTAO_CREDITO" | "PIX" | "TRANSFERENCIA",
  "valorRecebido": 60000.00,
  "observacoes": "Cliente pagou em esp√©cie"
}

A√ß√£o necess√°ria:
- Em pedidosBalcaoService.js, adicionar:
  async confirmarPagamento(pedidoId, dados) {
    const response = await api.put(`/pedidos/${pedidoId}/confirmar-pagamento`, dados)
    return response.data
  }

- Criar modal/tela para fechar conta:
  * Selecionar forma de pagamento
  * Input de valor recebido
  * Campo observa√ß√µes opcional
  * Bot√£o "Confirmar Pagamento"


üî¥ 6.3 - ADICIONAR SERVI√áO DE CONFIGURA√á√ÉO FINANCEIRA
Status: PENDENTE
Problema: N√£o temos service para consultar config

Backend endpoints:
- GET /api/configuracao-financeira
- POST /api/configuracao-financeira/pos-pago/ativar (ADMIN only)
- POST /api/configuracao-financeira/pos-pago/desativar (ADMIN only)

A√ß√£o necess√°ria:
- Criar src/services/configuracaoFinanceiraService.js:
  * getConfiguracao()
  * ativarPosPago()
  * desativarPosPago()

- Permiss√µes:
  * GET: ADMIN, GERENTE
  * POST: ADMIN apenas


üî¥ 6.4 - ADICIONAR HIST√ìRICO DE TRANSA√á√ïES DO FUNDO
Status: PENDENTE
Problema: Cliente n√£o consegue ver hist√≥rico de d√©bitos

Backend endpoint:
GET /api/fundos/{fundoId}/transacoes?dataInicio=2026-02-01&dataFim=2026-02-28&page=0&size=20

Retorna paginado:
{
  "content": [ ...transa√ß√µes... ],
  "totalElements": 156,
  "totalPages": 8
}

A√ß√£o necess√°ria:
- Em fundoConsumoService.js, adicionar:
  async getTransacoes(fundoId, filtros = {}) {
    const params = new URLSearchParams(filtros)
    const response = await api.get(`/fundos/${fundoId}/transacoes?${params}`)
    return response.data
  }

- Criar tela/modal HistoricoTransacoes.vue:
  * Lista paginada de transa√ß√µes
  * Filtros por data e tipo
  * Mostrar: data, tipo, valor, respons√°vel, observa√ß√£o


================================================================================
SE√á√ÉO 7: CASOS DE USO E CEN√ÅRIOS ESPECIAIS
================================================================================

üî¥ 7.1 - IMPLEMENTAR CANCELAMENTO DE PEDIDO
Status: PENDENTE
Problema: N√£o temos UI para cancelar pedido

Backend:
- Pedido em CRIADO: qualquer ADMIN/GERENTE/ATENDENTE pode cancelar
- Pedido em EM_ANDAMENTO: apenas ADMIN/GERENTE
- Cancelamento de PRE_PAGO: estorno autom√°tico e imediato

A√ß√£o necess√°ria:
- Em pedidosBalcaoService.js:
  * Adicionar endpoint DELETE /api/pedidos/{id}

- Em UI de detalhes do pedido:
  * Bot√£o "Cancelar Pedido"
  * Modal de confirma√ß√£o: "Tem certeza? Esta a√ß√£o n√£o pode ser desfeita"
  * Input de motivo (opcional)
  * Verificar permiss√£o baseado em status


üî¥ 7.2 - ADICIONAR/REMOVER ITENS DE PEDIDO EXISTENTE
Status: PENDENTE
Problema: N√£o h√° UI para editar pedido criado

Backend permite apenas se pedido em CRIADO:
- POST /api/pedidos/{id}/itens (adicionar)
- DELETE /api/pedidos/{id}/itens/{itemId} (remover - apenas ADMIN/GERENTE)

A√ß√£o necess√°ria:
- Criar modal EditarPedido.vue:
  * Mostrar itens atuais
  * Permitir adicionar novos produtos
  * Permitir remover itens (se ADMIN/GERENTE)
  * Recalcula total automaticamente
  * Desabilitar se status != CRIADO


üî¥ 7.3 - IMPLEMENTAR FECHAMENTO DE UNIDADE
Status: PENDENTE
Problema: N√£o h√° fluxo para liberar mesa ap√≥s cliente sair

Backend:
- PUT /api/unidades-consumo/{id}/fechar
- Valida se todos pedidos est√£o FINALIZADOS ou CANCELADOS
- Valida se n√£o h√° d√©bitos pendentes (POS_PAGO NAO_PAGO)
- Se OK: status ‚Üí DISPONIVEL, remove v√≠nculo com cliente

A√ß√£o necess√°ria:
- Em unidadesConsumoService.js, adicionar:
  async fecharUnidade(id) {
    const response = await api.put(`/unidades-consumo/${id}/fechar`)
    return response.data
  }

- Na UI de mesa/unidade:
  * Bot√£o "Fechar Mesa"
  * Validar localmente antes de enviar:
    - Todos pedidos finalizados?
    - Contas pagas?
  * Mostrar confirma√ß√£o
  * Ap√≥s fechar: redirecionar para lista de mesas


üî¥ 7.4 - IMPLEMENTAR DIVIS√ÉO DE CONTA (SPLIT BILL)
Status: PENDENTE (LIMITA√á√ÉO DO BACKEND)
Problema: Backend n√£o suporta divis√£o de conta em um pedido

Backend resposta (se√ß√£o 12.1):
"N√ÉO existe funcionalidade de split bill autom√°tica"

Solu√ß√£o recomendada:
- Criar PEDIDOS SEPARADOS desde o in√≠cio
- Cada pessoa = 1 pedido
- Todos vinculados √† mesma unidade

A√ß√£o necess√°ria:
- Documentar no README ou guia do usu√°rio
- Orientar atendentes a criar pedidos separados
- OU implementar workaround no frontend:
  * Modal "Dividir Conta"
  * Permite alocar itens entre N pessoas
  * Cria N pedidos automaticamente


================================================================================
SE√á√ÉO 8: TESTES E VALIDA√á√ïES
================================================================================

üî¥ 8.1 - TESTAR EM AMBIENTE STAGING
Status: PENDENTE

Backend forneceu credenciais de teste:
- URL STAGING: https://api-staging.restaurante.com
- Admin: +244999999999 / admin123
- Gerente: +244923456789 / gerente123
- Atendente: +244912345678 / atendente123

A√ß√£o necess√°ria:
- Atualizar .env com URL de staging
- Testar todos fluxos:
  * Criar pedido PRE_PAGO
  * Criar pedido POS_PAGO (como GERENTE)
  * Tentar POS_PAGO como ATENDENTE (deve dar 403)
  * Cancelar pedido
  * Adicionar/remover itens
  * WebSocket: receber atualiza√ß√µes em tempo real
  * Conflito de concorr√™ncia (dois atendentes, mesma mesa)


üî¥ 8.2 - TESTAR CEN√ÅRIOS DE ERRO
Status: PENDENTE

Cen√°rios obrigat√≥rios:
1. Criar pedido PRE_PAGO sem cliente na unidade (deve dar 400)
2. Criar pedido PRE_PAGO sem saldo suficiente (deve dar 400)
3. Tentar POS_PAGO como ATENDENTE (deve dar 403)
4. Criar pedido com p√≥s-pago desativado (deve dar 403)
5. Exceder limite p√≥s-pago da unidade (deve dar 400)
6. Adicionar produto inativo (deve dar 400)
7. Quantidade > 999 (deve dar 400)
8. Editar pedido EM_ANDAMENTO (deve dar 400)
9. Conflito de vers√£o - dois updates simult√¢neos (deve dar 409)


üî¥ 8.3 - VALIDAR PERMISS√ïES POR ROLE
Status: PENDENTE

Testar com cada role:
- ATENDENTE:
  * Pode criar PRE_PAGO ‚úì
  * N√ÉO pode criar POS_PAGO ‚úó
  * N√ÉO pode remover itens ‚úó
  * Pode cancelar pedido CRIADO ‚úì
  * N√ÉO pode cancelar EM_ANDAMENTO ‚úó
  * V√™ apenas pedidos da sua unidade

- GERENTE:
  * Pode criar PRE_PAGO ‚úì
  * Pode criar POS_PAGO ‚úì
  * Pode remover itens ‚úì
  * Pode cancelar qualquer pedido ‚úì
  * V√™ todos pedidos do estabelecimento

- ADMIN:
  * Acesso total


================================================================================
SE√á√ÉO 9: DOCUMENTA√á√ÉO E PADRONIZA√á√ÉO
================================================================================

üî¥ 9.1 - ATUALIZAR DOCUMENTA√á√ÉO DO PROJETO
Status: PENDENTE

Arquivos a atualizar:
- README.md: Adicionar se√ß√£o "Integra√ß√£o Backend"
- docs/IMPLEMENTACAO_PEDIDOS_COMPLETA.md: Atualizar com respostas backend
- ARQUITETURA_PEDIDOS.md: Adicionar detalhes dos endpoints reais

Conte√∫do a adicionar:
- URLs dos ambientes (DEV, STAGING, PROD)
- Estrutura exata dos payloads
- Todos os c√≥digos de erro poss√≠veis
- Permiss√µes por role
- Fluxos de WebSocket


üî¥ 9.2 - CRIAR GUIA DE TRATAMENTO DE ERROS
Status: PENDENTE

Criar docs/ERROS_COMUNS.md:
- Lista de todos erros poss√≠veis
- Status HTTP de cada
- Mensagem exata do backend
- Como tratar no frontend
- Feedback para usu√°rio

Baseado em: RESPOSTA_BACKEND_INTEGRACAO.txt se√ß√£o 9.2


üî¥ 9.3 - PADRONIZAR NOMES E TERMOS
Status: PENDENTE

Garantir consist√™ncia:
- Backend usa: PRE_PAGO, POS_PAGO
- Frontend deve usar: tipoPagamento: "PRE_PAGO" (n√£o "Pre-Pago", n√£o "prePago")
- Status: CRIADO, EM_ANDAMENTO, FINALIZADO, CANCELADO (uppercase com underscore)
- Roles: ADMIN, GERENTE, ATENDENTE, COZINHA (uppercase)


================================================================================
PRIORIZA√á√ÉO - ORDEM DE IMPLEMENTA√á√ÉO SUGERIDA
================================================================================

üî• SPRINT 1 - CORRE√á√ïES CR√çTICAS (1-2 dias):
1. Validar cliente vinculado antes de PRE_PAGO (1.2)
2. Validar permiss√µes para POS_PAGO (2.1)
3. Adicionar campo observa√ß√µes aos itens (1.4)
4. Atualizar coment√°rios FUNDO_CONSUMO ‚Üí PRE_PAGO (6.1)
5. Testar cria√ß√£o de pedido em STAGING (8.1)

‚ö° SPRINT 2 - VALIDA√á√ïES E SEGURAN√áA (2-3 dias):
6. Consultar status global de p√≥s-pago (2.2)
7. Validar quantidade m√°xima (2.3)
8. Validar produtos inativos (2.4)
9. Mensagens de erro amig√°veis (5.4)
10. Testar cen√°rios de erro (8.2)

üöÄ SPRINT 3 - WEBSOCKET E TEMPO REAL (3-4 dias):
11. Implementar conex√£o WebSocket (4.1)
12. Assinar t√≥picos corretos (4.2)
13. Tratar eventos WebSocket (4.3)
14. Reconex√£o autom√°tica (4.4)
15. Audio notification para pedido pronto (5.3)

üîß SPRINT 4 - FUNCIONALIDADES AVAN√áADAS (3-5 dias):
16. Implementar versionamento em atualiza√ß√µes (3.1)
17. Retry autom√°tico em conflito (3.2)
18. Confirmar pagamento POS_PAGO (6.2)
19. Cancelamento de pedido (7.1)
20. Adicionar/remover itens (7.2)
21. Fechamento de unidade (7.3)

üìä SPRINT 5 - UX E RELAT√ìRIOS (2-3 dias):
22. Mostrar dados do fundo ap√≥s cria√ß√£o (5.1)
23. Hist√≥rico de transa√ß√µes (6.4)
24. Progresso de subpedidos (5.2 - OPCIONAL)
25. Servi√ßo de configura√ß√£o financeira (6.3)

üìö SPRINT 6 - DOCUMENTA√á√ÉO E REFINAMENTO (1-2 dias):
26. Atualizar documenta√ß√£o (9.1)
27. Guia de erros (9.2)
28. Padronizar termos (9.3)
29. Validar permiss√µes por role (8.3)


================================================================================
RECURSOS E REFER√äNCIAS
================================================================================

Documentos-chave:
- RESPOSTA_BACKEND_INTEGRACAO.txt (este documento)
- CARTA_BACKEND_INTEGRACAO.txt (perguntas originais)
- docs/ARQUITETURA_PEDIDOS.md (arquitetura frontend j√° criada)
- docs/IMPLEMENTACAO_PEDIDOS_COMPLETA.md

Arquivos criados que podem ser aproveitados:
- src/api/pedido.api.js (camada HTTP profissional)
- src/services/pedido.service.js (l√≥gica de neg√≥cio)
- src/store/pedido.store.js (Pinia store com versionamento)
- src/composables/usePedido.js (interface reativa)
- src/utils/pedido.types.js (tipos e valida√ß√µes)
- src/utils/concurrency.helper.js (resolu√ß√£o de conflitos)

Backend endpoints principais:
- POST /api/pedidos (criar)
- GET /api/pedidos/{id} (detalhes)
- GET /api/pedidos/unidade-consumo/{id}/ativo (pedido ativo da unidade)
- PUT /api/pedidos/{id} (atualizar)
- DELETE /api/pedidos/{id} (cancelar)
- POST /api/pedidos/{id}/itens (adicionar item)
- DELETE /api/pedidos/{id}/itens/{itemId} (remover item)
- PUT /api/pedidos/{id}/confirmar-pagamento (fechar conta POS_PAGO)
- GET /api/configuracao-financeira (config global)
- WebSocket: ws://localhost:8080/ws (DEV)

Swagger:
- DEV: http://localhost:8080/swagger-ui.html
- STAGING: https://api-staging.restaurante.com/swagger-ui.html

Contatos backend:
- Slack: #backend-frontend
- Email: backend-team@restaurante.com
- Reuni√µes: Segunda/Quarta/Sexta 14h-16h


================================================================================
NOTAS FINAIS
================================================================================

Este plano cobre TODAS as integra√ß√µes necess√°rias baseadas nas respostas
detalhadas do backend. N√£o pulamos nenhuma informa√ß√£o cr√≠tica.

Priorize os Sprints 1 e 2 para ter sistema funcional b√°sico em produ√ß√£o.
Sprints 3-6 adicionam robustez, tempo real e UX avan√ßada.

Boa implementa√ß√£o! üöÄ

================================================================================
FIM DO PLANO DE A√á√ÉO
================================================================================
